@page "/incomes"
@inject HttpClient Http
@using MatBlazor 
@using ExpenseTracker.Shared.Models

<center>
    <h1>Incomes</h1>
    <p>
        <button class="btn btn-outline-success" @onclick="_ => OpenDialog()"><span class="oi oi-clipboard" aria-hidden="true">Add New Income</span></button>
    </p>
    @if (incomes == null)
    {
        <p><em>Loading...</em></p>
    }
    else
    {
        <table class='table'>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Amount</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var income in incomes)
                {
                    <tr>
                        <td>@income.ID</td>
                        <td>@income.Title</td>
                        <td>@income.Amount</td>
                        <td>
                            <a href='/editincome/@income.ID'>Edit</a>  |
                            <a href='/delete/@income.ID'>Delete</a>
                        </td>
                    </tr>

                }
            </tbody>
        </table>
    }
    
</center>
<MatDialog @bind-IsOpen="@dialogIsOpen">
    <MatDialogTitle>Add New Income</MatDialogTitle>
    <MatDialogContent>
        <AddIncome />
    </MatDialogContent>
    <MatDialogActions>
        <MatButton OnClick="OkClose">Close</MatButton>
    </MatDialogActions>
</MatDialog>
@code {
    Income[] incomes;
    bool dialogIsOpen = false;

    protected override async Task OnInitializedAsync()
    {
        incomes = await Http.GetFromJsonAsync<Income[]>("api/Expense/GetIncomes");
    }

    void OpenDialog()
    {
        dialogIsOpen = true;
    }

    void OkClose()
    {
        dialogIsOpen = false;
    }
}  